<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>চৌধুরী এগ্রো সার্ভিস</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>চৌধুরী এগ্রো সার্ভিস</h1>
    <p>গরু-মুরগির খামার ব্যবস্থাপনা ও হিসাব</p>
  </header>

  <nav>
    <a href="#inventory">স্টক</a>
    <a href="#history">হিস্টরি</a>
  </nav>

  <main>
    <section id="inventory">
      <h2>স্টক ম্যানেজমেন্ট</h2>
      <input type="text" id="itemName" placeholder="জিনিসের নাম" />
      <input type="number" id="itemQty" placeholder="পরিমাণ" />
      <button id="addBtn">স্টকে যোগ করুন</button>

      <table id="stockTable">
        <thead>
          <tr>
            <th>জিনিসের নাম</th>
            <th>পরিমাণ</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </section>

    <section id="history">
      <h2>স্টক হিস্টরি</h2>
      <ul id="historyList"></ul>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 চৌধুরী এগ্রো সার্ভিস</p>
  </footer>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCvGEZTFKPhmvVnvsg6hbu9xKkb8I_BbTg",
      authDomain: "chowdhury-agro-service-f91dd.firebaseapp.com",
      databaseURL: "https://chowdhury-agro-service-f91dd-default-rtdb.firebaseio.com", <!-- এই লাইনটা খুব জরুরি -->
      projectId: "chowdhury-agro-service-f91dd",
      storageBucket: "chowdhury-agro-service-f91dd.appspot.com",
      messagingSenderId: "61632086736",
      appId: "1:61632086736:web:3b44eb36f16414e0ce54d5"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ✅ Event binding
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("addBtn").addEventListener("click", () => {
        const nameInput = document.getElementById("itemName");
        const qtyInput = document.getElementById("itemQty");
        const name = nameInput.value.trim();
        const qty = parseInt(qtyInput.value.trim());

        if (!name || isNaN(qty)) {
          alert("সঠিকভাবে নাম ও পরিমাণ দিন");
          return;
        }

        // Write to Firebase Realtime Database
        set(ref(db, "stock/" + name), {
          quantity: qty,
          timestamp: new Date().toISOString()
        }).then(() => {
          console.log("Data written to Firebase");

          // ✅ Table update
          const tbody = document.querySelector("#stockTable tbody");
          const row = document.createElement("tr");
          row.innerHTML = `<td>${name}</td><td>${qty}</td>`;
          tbody.appendChild(row);

          // ✅ History update
          const historyList = document.getElementById("historyList");
          const li = document.createElement("li");
          li.textContent = `${name} (${qty}) স্টকে যোগ হয়েছে`;
          historyList.appendChild(li);

          // ✅ Clear input
          nameInput.value = "";
          qtyInput.value = "";
        }).catch((error) => {
          console.error("Firebase write failed:", error);
          alert("Firebase-এ লেখা যায়নি। Console চেক করুন।");
        });
      });
    });
  </script>
</body>
</html>
